{"_path":"/articles/css/csspropertyatrule","_dir":"css","_draft":false,"_partial":false,"_locale":"zh-Hans","_empty":false,"title":"纯 css 实现数字自增的动画效果","description":"","body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"前言"},"children":[{"type":"text","value":"前言"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"最近在群里摸鱼时,讨论到 css houdini 能提供哪些能力,其中有一些能力还在规范中,有一些能力已经被部分浏览器支持了。我于是找到其中一个新增的 at-rule css 规则 @property,并且写了这个例子,看一下能提供哪些之前 css 可能无法实现的功能。文中提到的一些概念都可以在参考链接中获取更详细的信息"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"废话不多说,直接上代码"}]},{"type":"element","tag":"h2","props":{"id":"html"},"children":[{"type":"text","value":"html"}]},{"type":"element","tag":"code","props":{"code":"<body>\n  <div class=\"box\"></div>\n  <div class=\"box item2\"></div>\n</body>\n","language":"html","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-adb688"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-667e62"},"children":[{"type":"text","value":"body"}]},{"type":"element","tag":"span","props":{"class":"ct-adb688"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-adb688"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-667e62"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-5fd359"},"children":[{"type":"text","value":"\"box\""}]},{"type":"element","tag":"span","props":{"class":"ct-adb688"},"children":[{"type":"text","value":"></"}]},{"type":"element","tag":"span","props":{"class":"ct-667e62"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-adb688"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-adb688"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-667e62"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-5fd359"},"children":[{"type":"text","value":"\"box item2\""}]},{"type":"element","tag":"span","props":{"class":"ct-adb688"},"children":[{"type":"text","value":"></"}]},{"type":"element","tag":"span","props":{"class":"ct-667e62"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"class":"ct-adb688"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-adb688"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"class":"ct-667e62"},"children":[{"type":"text","value":"body"}]},{"type":"element","tag":"span","props":{"class":"ct-adb688"},"children":[{"type":"text","value":">"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"css"},"children":[{"type":"text","value":"css"}]},{"type":"element","tag":"code","props":{"code":"body {\n  margin: 0;\n  min-height: 100vh;\n  display: flex;\n}\n.box {\n  width: 200px;\n  height: 200px;\n  border: 10px solid #000;\n  background-color: rebeccapurple;\n  margin: auto;\n  font-size: 100px;\n  color: rgb(255, 255, 255);\n  text-align: center;\n  line-height: 200px;\n  position: relative;\n  --step: 0;\n  counter-reset: count var(--step);\n  z-index: var(--step);\n  transition: --step 10s;\n}\n.box::before {\n  content: counter(count);\n}\n.box.item2::before {\n  content: counter(count, cjk-heavenly-stem);\n}\n.box:hover {\n  --step: 100;\n}\n@property --step {\n  syntax: '<integer>';\n  inherits: true;\n  initial-value: 0;\n}\n","language":"css","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-6f944f"},"children":[{"type":"text","value":"body"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"margin"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-99469d"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"min-height"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-99469d"},"children":[{"type":"text","value":"100vh"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"display"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-5fd359"},"children":[{"type":"text","value":"flex"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-6f944f"},"children":[{"type":"text","value":".box"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"width"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-99469d"},"children":[{"type":"text","value":"200px"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"height"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-99469d"},"children":[{"type":"text","value":"200px"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"border"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-99469d"},"children":[{"type":"text","value":"10px"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5fd359"},"children":[{"type":"text","value":"solid"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5fd359"},"children":[{"type":"text","value":"#000"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"background-color"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-5fd359"},"children":[{"type":"text","value":"rebeccapurple"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"margin"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-5fd359"},"children":[{"type":"text","value":"auto"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"font-size"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-99469d"},"children":[{"type":"text","value":"100px"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"color"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-a7215c"},"children":[{"type":"text","value":"rgb"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-99469d"},"children":[{"type":"text","value":"255"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-99469d"},"children":[{"type":"text","value":"255"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-99469d"},"children":[{"type":"text","value":"255"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"text-align"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-5fd359"},"children":[{"type":"text","value":"center"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"line-height"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-99469d"},"children":[{"type":"text","value":"200px"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"position"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-5fd359"},"children":[{"type":"text","value":"relative"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"--step"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-99469d"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"counter-reset"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": count "}]},{"type":"element","tag":"span","props":{"class":"ct-a7215c"},"children":[{"type":"text","value":"var"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"--step"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"z-index"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-a7215c"},"children":[{"type":"text","value":"var"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"--step"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"transition"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": --step "}]},{"type":"element","tag":"span","props":{"class":"ct-99469d"},"children":[{"type":"text","value":"10s"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"class":"ct-6f944f"},"children":[{"type":"text","value":".box::before"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"content"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-a7215c"},"children":[{"type":"text","value":"counter"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"count"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"class":"ct-6f944f"},"children":[{"type":"text","value":".box.item2::before"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"content"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-a7215c"},"children":[{"type":"text","value":"counter"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"count"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-5fd359"},"children":[{"type":"text","value":"cjk-heavenly-stem"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"class":"ct-6f944f"},"children":[{"type":"text","value":".box:hover"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"--step"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-99469d"},"children":[{"type":"text","value":"100"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"class":"ct-ba7f29"},"children":[{"type":"text","value":"@property"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":" --step {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  syntax: '<integer>';\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  inherits: true;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-667e62"},"children":[{"type":"text","value":"initial-value"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": 0;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"效果"},"children":[{"type":"text","value":"效果"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"动画.gif","src":"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/22dc659c0494462883a6c9e69a33a70f~tplv-k3u1fbpfcp-watermark.image"},"children":[]}]},{"type":"element","tag":"h2","props":{"id":"思路"},"children":[{"type":"text","value":"思路"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"由于是使用纯 css 实现,第一步就是把 css 设置的信息显示出来,这里使用了 content 配合伪元素,很多时候我们使用到 content 时,可能只提供一个 <string> 类型值,但是还可以设置其他值,例如 attr(), count() 等类型。因为这里要做动画,选择 <string> 类型自然是无法实现的,在 content 的语法中,找到了 count() 函数,这个函数可以读取计数器的值,而计数器值类型是 <integer> 类型,该类型可以从 counter-reset 属性支持的语法中知道,其语法是 "},{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":" <custom-ident> <integer>?"}]},{"type":"text","value":"+ | none。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在前面我提到了类型和语法,这个我们在学 css 时可能不太会注意的东西,但是在这里必须要说一下,因为在 @property 中要用到。我们设置任何一个 css 属性的属性值时,这些属性值都是由不同的数据类型的值组合而成,比如 width: 10px,其中 10px 就是 <length> 类型,但是我们知道 width: auto 也是可以的,如果我们查看 mdn 文档就可以发现 width 的语法是"}]},{"type":"element","tag":"code","props":{"code":"[ <length> | <percentage> ] && [ border-box | content-box ]? | available | min-content | max-content | fit-content | auto\n","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[ <length> | <percentage> ] && [ border-box | content-box ]? | available | min-content | max-content | fit-content | auto"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"通过该语法就可以知道 width 可以支持设置哪些属性值,如果要读懂这些语法,需要了解 css 的属性值定义语法和 css 数据类型,通过下面的链接可以获取更多这些信息。有时我们发现 css 要记的属性和属性值太多太杂了,但是只要了解数据类型和语法,记忆的东西就可以大大减少,因为很多的语法和类型都可以复用的。例如 <position> 类型就可以用到 background-position 和 object-position 属性上。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"现在回归正题,如果要实现动画,自然要让计数器的值发生变化,这里使用了 hover 悬停触发改变,当然可以是其他的触发方法。如果使用"}]},{"type":"element","tag":"code","props":{"code":".box:hover {\n  counter-reset: count 100;\n}\n","language":"css","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-6f944f"},"children":[{"type":"text","value":".box:hover"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"counter-reset"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":": count "}]},{"type":"element","tag":"span","props":{"class":"ct-99469d"},"children":[{"type":"text","value":"100"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"是无法让过渡动画生效的,要让动画生效,需要对应的数据类型支持插值。counter-reset 中只有 <integer> 部分支持插值,整体是不支持插值的,具体哪些能插哪些不能插可以查询 css 数据类型中对每一个数据类型的介绍。如果要实现部分变化,可以使用 var() 函数, var() 函数可以读取自定义属性的值,只要让自定义属性发生变化就可以了。如果对自定义属性不了解的可以查看下面的链接。自定义属性必须前面添加 --,并且是区分大小写的,在使用上支持 var() 进行读取,而其余行为和样式属性是类似的,比如一样受级联影响。在没有设置 @property 规则时,自定义属性是可继承的属性,允许自定义属性设置任何类型的值。所以当设置 --setp: 0 时,会认为该自定义属性不支持插值,如果从 js 角度去看自定义属性"}]},{"type":"element","tag":"code","props":{"code":"document.querySelector('.box').computedStyleMap().get('--step');\n// CSSUnparsedValue {0: \" 0\", length: 1}\n","language":"js","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"document"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-a7215c"},"children":[{"type":"text","value":"querySelector"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-5fd359"},"children":[{"type":"text","value":"'.box'"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":")."}]},{"type":"element","tag":"span","props":{"class":"ct-a7215c"},"children":[{"type":"text","value":"computedStyleMap"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"()."}]},{"type":"element","tag":"span","props":{"class":"ct-a7215c"},"children":[{"type":"text","value":"get"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-5fd359"},"children":[{"type":"text","value":"'--step'"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-19f656"},"children":[{"type":"text","value":"// CSSUnparsedValue {0: \" 0\", length: 1}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"会返回 CSSUnparsedValue 对象,该对象是 cssom 规范中提供的对象,字面解释就是一个没有被解析的值,自然也不支持插值。这里提到的 cssom 表示 CSS 对象模型,有点类似 DOM,允许通过 js 的方式来操作 CSS, css houdini 为我们暴露了更多的底层接口,这也是其能力的一个方面。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"到目前为止,如果没有设置 @property 规则,动画依然是不支持的,经过我之前的描述,可能大家都知道 @property 作用了。@property 提供了我们控制自定义属性的能力,比如 syntax 是用来限制自定义属性支持的数据类型的,设置为可以插值类型 <integer> 后再次通过 js 读取自定义属性"}]},{"type":"element","tag":"code","props":{"code":"document.querySelector('.box').computedStyleMap().get('--step');\n// CSSUnitValue {value: 0, unit: \"number\"}\n","language":"js","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-d154d3"},"children":[{"type":"text","value":"document"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-a7215c"},"children":[{"type":"text","value":"querySelector"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-5fd359"},"children":[{"type":"text","value":"'.box'"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":")."}]},{"type":"element","tag":"span","props":{"class":"ct-a7215c"},"children":[{"type":"text","value":"computedStyleMap"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"()."}]},{"type":"element","tag":"span","props":{"class":"ct-a7215c"},"children":[{"type":"text","value":"get"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-5fd359"},"children":[{"type":"text","value":"'--step'"}]},{"type":"element","tag":"span","props":{"class":"ct-277d03"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-19f656"},"children":[{"type":"text","value":"// CSSUnitValue {value: 0, unit: \"number\"}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"已经不是一个没有被解释的对象了。而 inherits 属性是控制该自定义属性是否可以继承。initial-value 就是在 var() 读取不到自定义属性值时采用的默认值。"}]},{"type":"element","tag":"h2","props":{"id":"总结"},"children":[{"type":"text","value":"总结"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"这是一个非常简单的例子,但通过这个例子可以发散出其他有意思的实现,比如实现渐变动画,布局动画等等。更重要的是这里实现的能力只是 css houdini 的冰山一角,而且 css houdini 在性能上是非常出色的,期待 css houdini 的发展。"}]},{"type":"element","tag":"h2","props":{"id":"参考链接"},"children":[{"type":"text","value":"参考链接"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://developer.mozilla.org/en-US/docs/Web/CSS/@property","rel":["nofollow"]},"children":[{"type":"text","value":"@property CSS at-rule "}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://developer.mozilla.org/en-US/docs/Web/Guide/Houdini","rel":["nofollow"]},"children":[{"type":"text","value":"CSS Houdini 介绍"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://developer.mozilla.org/en-US/docs/Web/CSS/content","rel":["nofollow"]},"children":[{"type":"text","value":"content 属性"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://developer.mozilla.org/en-US/docs/Web/CSS/counter-reset","rel":["nofollow"]},"children":[{"type":"text","value":"counter-reset 属性"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://developer.mozilla.org/en-US/docs/Web/CSS/Value_definition_syntax","rel":["nofollow"]},"children":[{"type":"text","value":"属性值定义语法"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Types","rel":["nofollow"]},"children":[{"type":"text","value":"css 数据类型"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties","rel":["nofollow"]},"children":[{"type":"text","value":"css 自定义属性"}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-19f656{color:#6A9955}\n.ct-ba7f29{color:#C586C0}\n.ct-a7215c{color:#DCDCAA}\n.ct-99469d{color:#B5CEA8}\n.ct-6f944f{color:#D7BA7D}\n.ct-5fd359{color:#CE9178}\n.ct-d154d3{color:#9CDCFE}\n.ct-277d03{color:#D4D4D4}\n.ct-667e62{color:#569CD6}\n.ct-adb688{color:#808080}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"前言","depth":2,"text":"前言"},{"id":"html","depth":2,"text":"html"},{"id":"css","depth":2,"text":"css"},{"id":"效果","depth":2,"text":"效果"},{"id":"思路","depth":2,"text":"思路"},{"id":"总结","depth":2,"text":"总结"},{"id":"参考链接","depth":2,"text":"参考链接"}]}},"_type":"markdown","_id":"content:articles:css:CSSPropertyAtRule.md","_source":"content","_file":"articles/css/CSSPropertyAtRule.md","_extension":"md"}